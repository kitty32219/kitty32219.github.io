<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>å°æ¸¬é©—ï¼šé£Ÿç‰©æ¶ˆåŒ–æ—…ç¨‹</title>
  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      background-color: #f3f3f3;
      color: #333;
      max-width: 700px;
      margin: 40px auto;
      line-height: 1.6;
    }
    h1 {
      text-align: center;
      font-size: 1.8em;
      margin-bottom: 0.2em;
    }
    .note {
      text-align: center;
      font-size: 0.9em;
      color: #666;
      margin-bottom: 1.5em;
    }
    .question {
      margin-bottom: 1.5em;
      padding: 1em;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #fff;
    }
    .question p {
      font-size: 1.1em;
      font-weight: bold;
    }
    .sortable-container {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5em;
      margin: 1em 0;
      position: relative;
    }
    .sortable-slot {
      min-width: 80px;
      padding: 0.6em;
      border: 2px dashed #aaa;
      border-radius: 6px;
      text-align: center;
      background: #fafafa;
      user-select: none;
      cursor: grab;
    }
    .arrow {
      font-size: 1.2em;
      color: #999;
    }
    button {
      margin-top: 0.5em;
      padding: 0.5em 1em;
      border: none;
      background-color: #333;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #555;
    }
    .result {
      margin-top: 0.5em;
      font-size: 0.95em;
    }
    .wrong {
      color: #c00;
      font-weight: bold;
    }
    .correct {
      color: #060;
      font-weight: bold;
    }
    #finalResult {
      margin-top: 2em;
      padding: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fafafa;
      text-align: center;
      display: none;
    }
    .code {
      color: red;
      font-weight: bold;
    }
    .condition {
      color: #666;
      font-size: 0.9em;
    }
    #options {
  position: relative;
}
    a {
      color: #333;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>é£Ÿç‰©æ¶ˆåŒ–æ—…ç¨‹ 3 é¡Œå°æ¸¬é©—</h1>
  <p class="note">å…¨å°å¯ä»¥ç²å¾—å°ˆå±¬æŠ˜æ‰£ç¢¼</p>

  <!-- å•é¡Œ 1 æ’åºé¡Œ -->
  <div class="question" id="q1">
    <p>å•é¡Œ 1ï¼šè«‹æ‹–æ›³ä¸‹åˆ—é …ç›®ï¼Œæ’åˆ—æ­£ç¢ºçš„æ¶ˆåŒ–é †åºï¼š</p>
    <div id="slots" class="sortable-container">
      <div class="sortable-slot" data-answer="">&nbsp;</div><span class="arrow">â†’</span>
      <div class="sortable-slot" data-answer="">&nbsp;</div><span class="arrow">â†’</span>
      <div class="sortable-slot" data-answer="">&nbsp;</div><span class="arrow">â†’</span>
      <div class="sortable-slot" data-answer="">&nbsp;</div><span class="arrow">â†’</span>
      <div class="sortable-slot" data-answer="">&nbsp;</div><span class="arrow">â†’</span>
      <div class="sortable-slot" data-answer="">&nbsp;</div>
    </div>

    <p>é¸é …ï¼š</p>
    <div id="options" class="sortable-container"></div>
    <button onclick="resetQ1()">é‡è¨­ç¬¬ä¸€é¡Œ</button>
    <div class="result" id="res1"></div>
  </div>

  <!-- å•é¡Œ 2 -->
  <div class="question" id="q2">
    <p>å•é¡Œ 2ï¼šé£Ÿç‰©ä¸­çš„è›‹ç™½è³ªåœ¨å“ªå€‹éƒ¨ä½æœƒé–‹å§‹è¢«åˆ†è§£ï¼Ÿ</p>
    <label><input type="radio" name="q2" value="a"> a. èƒƒéƒ¨</label><br>
    <label><input type="radio" name="q2" value="b"> b. å°è…¸</label><br>
    <label><input type="radio" name="q2" value="c"> c. å¤§è…¸</label><br>
    <div class="result" id="res2"></div>
  </div>

  <!-- å•é¡Œ 3 -->
  <div class="question" id="q3">
    <p>å•é¡Œ 3ï¼šå¤§è…¸çš„ä¸»è¦åŠŸèƒ½æ˜¯ä»€éº¼ï¼Ÿ</p>
    <label><input type="radio" name="q3" value="a"> a. å¸æ”¶å¤§éƒ¨åˆ†ç‡Ÿé¤Š</label><br>
    <label><input type="radio" name="q3" value="b"> b. å¸æ”¶æ°´åˆ†èˆ‡é›»è§£è³ªï¼Œä¸¦ç”±è…¸é“èŒç™¼é…µéƒ¨åˆ†çº–ç¶­</label><br>
    <label><input type="radio" name="q3" value="c"> c. é–‹å§‹æ¾±ç²‰åˆ†è§£</label><br>
    <div class="result" id="res3"></div>
  </div>

  <button onclick="finalSubmit()">äº¤å‡ºç­”æ¡ˆ</button>
  <div id="finalResult"></div>

  <script>
    let score = 0;
    let answered = {q1:false, q2:false, q3:false};

    const slotElements = document.querySelectorAll("#slots .sortable-slot");
    const optionContainer = document.getElementById("options");
    const correctOrder = ["å£è…”", "é£Ÿé“", "èƒƒéƒ¨", "å°è…¸", "å¤§è…¸", "è‚›é–€"];
    let dragItem = null;
    let offsetX = 0, offsetY = 0;

    function enableDrag(element){
      // æ¡Œæ©Ÿæ‹–æ‹‰
      element.addEventListener("dragstart", e => {
        dragItem = e.target;
        setTimeout(() => e.target.style.opacity = "0.5", 0);
      });
      element.addEventListener("dragend", e => {
        e.target.style.opacity = "1";
        dragItem = null;
      });

      // æ‰‹æ©Ÿæ‹–æ‹‰
element.addEventListener("touchstart", e => {
  dragItem = e.target;
  const touch = e.touches[0];
  const rect = dragItem.getBoundingClientRect();
  offsetX = touch.clientX - rect.left;
  offsetY = touch.clientY - rect.top;

  dragItem.style.position = "absolute";
  dragItem.style.zIndex = "1000";

  // æ”¾åˆ° container çš„æœ€ä¸Šå±¤
  optionContainer.appendChild(dragItem);
});

element.addEventListener("touchmove", e => {
  e.preventDefault();
  const touch = e.touches[0];
  const containerRect = optionContainer.getBoundingClientRect();
  dragItem.style.left = (touch.clientX - offsetX - containerRect.left) + "px";
  dragItem.style.top = (touch.clientY - offsetY - containerRect.top) + "px";
});

element.addEventListener("touchend", e => {
  let placed = false;
  slotElements.forEach(slot => {
    const rect = slot.getBoundingClientRect();
    const midX = dragItem.getBoundingClientRect().left + dragItem.offsetWidth/2;
    const midY = dragItem.getBoundingClientRect().top + dragItem.offsetHeight/2;
    if(slot.getAttribute("data-answer")=="" &&
       midX > rect.left && midX < rect.right &&
       midY > rect.top && midY < rect.bottom){
      slot.textContent = dragItem.textContent;
      slot.setAttribute("data-answer", dragItem.textContent);
      placed = true;
    }
  });

  // å¦‚æœæ²’æ”¾åˆ°ç©ºç™½æ ¼ï¼Œå°±å›åˆ°é¸é …æ¬„
  if(!placed){
    dragItem.style.position = "static";
    dragItem.style.left = "";
    dragItem.style.top = "";
    dragItem.style.zIndex = "";
  } else {
    dragItem.style.position = "static";
    dragItem.style.left = "";
    dragItem.style.top = "";
    dragItem.style.zIndex = "";
  }

dragItem = null;
    }

    // åˆå§‹åŒ–é¸é …
    function initQ1Options(){
      optionContainer.innerHTML = "";
      const shuffled = [...correctOrder].sort(() => Math.random() - 0.5);
      shuffled.forEach(item => {
        const div = document.createElement("div");
        div.className = "sortable-slot";
        div.textContent = item;
        div.setAttribute("draggable", "true");
        optionContainer.appendChild(div);
        enableDrag(div);
      });
    }

    // slotElements touch æ”¯æ´
    slotElements.forEach(slot=>{
      slot.addEventListener("dragover", e=>e.preventDefault());
      slot.addEventListener("drop", e=>{
        if(dragItem && slot.getAttribute("data-answer")==""){
          slot.textContent = dragItem.textContent;
          slot.setAttribute("data-answer", dragItem.textContent);
          dragItem.style.display="none";
        }
      });
    });

    function resetQ1(){
      slotElements.forEach(slot=>{
        slot.textContent="\xa0";
        slot.setAttribute("data-answer","");
      });
      initQ1Options();
      document.getElementById("res1").innerHTML="";
      answered.q1=false;
    }

    function checkQ1(){
      let items = Array.from(slotElements).map(div=>div.getAttribute("data-answer"));
      let res = document.getElementById("res1");
      if(JSON.stringify(items) === JSON.stringify(correctOrder)){
        res.innerHTML = "<span class='correct'>âœ” æ­£ç¢ºï¼</span> é£Ÿç‰©ç”±å£è…” â†’ é£Ÿé“ â†’ èƒƒéƒ¨ â†’ å°è…¸ â†’ å¤§è…¸ â†’ è‚›é–€ã€‚";
        score++;
      } else {
        res.innerHTML = "<span class='wrong'>âŒ éŒ¯èª¤ï¼</span>";
      }
      answered.q1 = true;
    }

    function checkQ2(){
      let choice = document.querySelector('input[name="q2"]:checked');
      let res = document.getElementById("res2");
      if(!choice) return;
      if(choice.value==="a"){
        res.innerHTML = "<span class='correct'>âœ” æ­£ç¢ºï¼</span> èƒƒéƒ¨åˆ†æ³Œèƒƒè›‹ç™½é…¶èˆ‡èƒƒé…¸ï¼Œé–‹å§‹åˆ†è§£è›‹ç™½è³ªã€‚";
        score++;
      } else { res.innerHTML="<span class='wrong'>âŒ éŒ¯èª¤ï¼</span>"; }
      answered.q2 = true;
    }

    function checkQ3(){
      let choice = document.querySelector('input[name="q3"]:checked');
      let res = document.getElementById("res3");
      if(!choice) return;
      if(choice.value==="b"){
        res.innerHTML="<span class='correct'>âœ” æ­£ç¢ºï¼</span> å¤§è…¸å¸æ”¶æ°´åˆ†èˆ‡é›»è§£è³ªï¼Œä¸¦ç”±è…¸é“èŒç™¼é…µéƒ¨åˆ†çº–ç¶­ã€‚";
        score++;
      } else { res.innerHTML="<span class='wrong'>âŒ éŒ¯èª¤ï¼</span>"; }
      answered.q3=true;
    }

    function finalSubmit(){
      checkQ1();
      checkQ2();
      checkQ3();
      let final = document.getElementById("finalResult");
      if(!(answered.q1 && answered.q2 && answered.q3)){
        alert("è«‹å…ˆå®Œæˆæ‰€æœ‰é¡Œç›®ï¼");
        return;
      }
      if(score===3){
        final.style.display="block";
        final.innerHTML=`ğŸ‰ æ­å–œå…¨å°ï¼é€™æ˜¯ä½ çš„æŠ˜æ‰£ç¢¼ï¼š <span class="code">809777</span><br>
        <span class="condition">ç„¡ä½¿ç”¨æœŸé™ï¼Œæ»¿999æŠ˜30</span><br>
        <a href="https://www.dgifood.com.tw/member_login.php?lang=tw" target="_blank">é»æ­¤ä½¿ç”¨</a>`;
      } else {
        final.style.display="none"; // éŒ¯èª¤ä¸é¡¯ç¤ºè¨Šæ¯
      }
    }

    initQ1Options();
  </script>
</body>
</html>
