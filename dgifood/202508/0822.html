<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MCT 生酮 vs 傳統生酮小測驗</title>
<style>
  :root{
    --bg:#f5f5f5;
    --text:#333;
    --muted:#777;
    --line:#ddd;
    --accent:#0a84ff;
    --ok:#2e7d32;
    --err:#c62828;
  }
  body{
    font-family: -apple-system, BlinkMacSystemFont, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    margin: 0; padding: 24px;
  }
  .wrap{max-width: 780px; margin: 0 auto;}
  h1{font-weight: 500; text-align: center; margin: 8px 0 4px;}
  .note{color: var(--muted); text-align:center; margin-bottom: 24px;}
  .card{
    background: #fff; border: 1px solid var(--line); border-radius: 16px;
    padding: 18px 16px; margin-bottom: 16px;
  }
  .q{ text-align: center; font-size: 18px; margin: 0 0 12px;}
  .options{ display: grid; gap: 8px; justify-items: center; }
  .btn{
    background:#fff; border:1px solid var(--line); border-radius:12px;
    padding:10px 16px; cursor:pointer; min-width: 220px;
  }
  .btn:focus{ outline:2px solid var(--accent); outline-offset:2px;}
  .btn.selected{ border-color: var(--accent); background:#f0f6ff; }
  .feedback{ margin-top: 10px; font-size: 14px; text-align:center; min-height: 20px;}
  .ok{ color: var(--ok);}
  .err{ color: var(--err);}

  /* 拖拉配對 */
  .pairing{
    display: grid; grid-template-columns: 1fr 1fr; gap: 14px; align-items: start;
  }
  .bank, .targets{
    border: 1px dashed var(--line); border-radius: 12px; padding: 12px; background:#fafafa;
  }
  .bank-title, .targets-title{ font-size: 14px; color: var(--muted); margin-bottom: 8px; text-align:center;}
  .chips{ display: grid; gap: 8px; }
  .chip{
    border:1px solid var(--line); background:#fff; border-radius: 999px;
    padding:8px 12px; text-align:center; cursor: grab; user-select:none;
  }
  .targets .row{ display:grid; grid-template-columns: 120px 1fr; gap: 8px; align-items:center; }
  .drop{
    min-height: 40px; border:1px solid var(--line); border-radius: 10px; background:#fff;
    display:flex; align-items:center; justify-content:center; padding:6px;
  }
  .drop.over{ outline:2px solid var(--accent);}
  .tools{ display:flex; justify-content:center; margin-top:10px;}
  .ghost{ opacity: .5;}
  /* 提交/折扣 */
  .submit{
    display:block; margin: 20px auto; padding: 12px 22px; border-radius: 999px;
    background:#111; color:#fff; border:none; cursor:pointer;
  }
  .discount{
    display:none; text-align:center; border:1px solid var(--line); background:#fff; border-radius:16px;
    padding:18px; margin-top:16px;
  }
  .discount .code{ color:#d32f2f; font-weight:700; font-size:20px;}
  .discount .desc{ color:#9e9e9e; margin:6px 0 10px;}
  a.link{ color:#0a84ff; text-decoration:none; }
  @media (max-width: 600px){
  .pairing{
    grid-template-columns: 1fr; /* 單欄，變上下 */
  }
}
</style>
</head>
<body>
  <div class="wrap">
    <h1>MCT 生酮 vs 傳統生酮小測驗</h1>
    <div class="note">完成 3 題並全對，可獲得專屬折扣碼</div>

    <!-- Q1 -->
    <section class="card question" data-type="single" data-answer="MCT" data-explain="解析：中鏈脂肪酸（MCT）不需膽汁乳化、可直達肝臟代謝，吸收比長鏈脂肪酸（LCT）更快。">
      <p class="q">1. 長鏈脂肪與中鏈脂肪哪個比較快被人體消化吸收？</p>
      <div class="options">
        <button class="btn">中鏈脂肪酸（MCT）</button>
        <button class="btn">長鏈脂肪酸（LCT）</button>
      </div>
      <div class="feedback"></div>
    </section>

    <!-- Q2 drag-match -->
    <section class="card question" data-type="match" data-explain="解析：最初的 MCT 生酮比例多採 MCT油 50%｜其他油脂 21%｜蛋白質 10%｜碳水 19%。">
      <p class="q">2. 最初的 MCT 生酮飲食營養比例配對（拖拉配對題，手機使用時須長按選項以正常執行）</p>
      <div class="pairing">
        <div class="bank">
          <div class="bank-title">拖曳下列項目至右側百分比</div>
          <div class="chips" id="bank">
            <div class="chip" draggable="true" data-key="MCT">MCT油脂</div>
            <div class="chip" draggable="true" data-key="OTHER">其他油脂</div>
            <div class="chip" draggable="true" data-key="PRO">蛋白質</div>
            <div class="chip" draggable="true" data-key="CARB">碳水化合物</div>
          </div>
          <div class="tools">
            <button class="btn" id="resetQ2" type="button">重設</button>
          </div>
        </div>
        <div class="targets">
          <div class="targets-title">將項目放到相對應的比例</div>
          <div class="chips">
            <div class="row">
              <div>50%</div>
              <div class="drop" data-accept="MCT"></div>
            </div>
            <div class="row">
              <div>21%</div>
              <div class="drop" data-accept="OTHER"></div>
            </div>
            <div class="row">
              <div>10%</div>
              <div class="drop" data-accept="PRO"></div>
            </div>
            <div class="row">
              <div>19%</div>
              <div class="drop" data-accept="CARB"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="feedback"></div>
    </section>

    <!-- Q3 -->
    <section class="card question" data-type="single" data-answer="MCT" data-explain="解析：MCT 生酮飲食因酮體生成效率高，能容許較多碳水（約占總熱量 19%），飲食彈性較大。">
      <p class="q">3. 如果希望飲食中允許攝取較多的碳水化合物，應該選擇哪一種？</p>
      <div class="options">
        <button class="btn">MCT 生酮飲食</button>
        <button class="btn">傳統生酮飲食</button>
      </div>
      <div class="feedback"></div>
    </section>

    <button class="submit" id="submit">提交答案</button>

    <div class="discount" id="discount">
      <p>🎉 恭喜全對！這是你的折扣碼：<span class="code">314353</span></p>
      <p class="desc">無使用期限，滿999折30</p>
      <p><a class="link" href="https://www.dgifood.com.tw/member_login.php?lang=tw" target="_blank" rel="noopener">點此使用</a></p>
    </div>
  </div>

<script>
/* 單選題點選樣式 */
document.querySelectorAll('.question[data-type="single"]').forEach(q=>{
  q.querySelectorAll('.btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      q.querySelectorAll('.btn').forEach(b=>b.classList.remove('selected'));
      btn.classList.add('selected');
    });
  });
});

/* 拖拉配對邏輯 */
const bank = document.getElementById('bank');
const drops = document.querySelectorAll('.drop');
let dragEl = null;

function makeDraggable(el){
  el.addEventListener('dragstart', (e)=>{
    dragEl = el;
    el.classList.add('ghost');
    e.dataTransfer.setData('text/plain', el.dataset.key);
  });
  el.addEventListener('dragend', ()=>{
    dragEl && dragEl.classList.remove('ghost');
    dragEl = null;
  });
}
document.querySelectorAll('.chip').forEach(makeDraggable);

drops.forEach(drop=>{
  drop.addEventListener('dragover', (e)=>{ e.preventDefault(); drop.classList.add('over'); });
  drop.addEventListener('dragleave', ()=> drop.classList.remove('over'));
  drop.addEventListener('drop', (e)=>{
    e.preventDefault();
    drop.classList.remove('over');
    const key = e.dataTransfer.getData('text/plain');
    if(!dragEl) return;

    // 每個 drop 只放一個；若已有，先放回題庫
    if(drop.firstElementChild){
      bank.appendChild(drop.firstElementChild);
    }
    drop.appendChild(dragEl);
  });
});

/* 重設配對 */
document.getElementById('resetQ2').addEventListener('click', ()=>{
  document.querySelectorAll('.drop').forEach(d=>{
    if(d.firstElementChild){ bank.appendChild(d.firstElementChild); }
  });
  // 清除第二題回饋
  const q2 = document.querySelectorAll('.question')[1];
  q2.querySelector('.feedback').textContent = '';
});

/* 評分 */
document.getElementById('submit').addEventListener('click', ()=>{
  let allCorrect = true;

  document.querySelectorAll('.question').forEach((q, idx)=>{
    const type = q.dataset.type;
    const feedback = q.querySelector('.feedback');
    feedback.textContent = ''; // reset

    // Q1 & Q3 單選題
    if(type === 'single'){
      const ans = q.dataset.answer; // "MCT"
      const selected = q.querySelector('.btn.selected');
      if(!selected){
        feedback.innerHTML = '<span class="err">尚未選擇答案</span>';
        allCorrect = false;
        return;
      }
      const text = selected.textContent.trim();
      const picked = text.includes('MCT') ? 'MCT' : (text.includes('傳統') || text.includes('LCT') ? 'LCT' : text);
      const isRight = (ans === 'MCT' && picked==='MCT') || (ans==='LCT' && picked==='LCT');

      if(isRight){
        feedback.innerHTML = `<span class="ok">正確 ✅</span>　${q.dataset.explain}`;
      }else{
        feedback.innerHTML = `<span class="err">錯誤 ❌</span>`;
        allCorrect = false;
      }
    }

    // Q2 配對題
    if(type === 'match'){
      let ok = true;
      drops.forEach(drop=>{
        const need = drop.dataset.accept;
        const chip = drop.firstElementChild;
        if(!chip){ ok = false; }
        else if(chip.dataset.key !== need){ ok = false; }
      });

      if(ok){
        feedback.innerHTML = `<span class="ok">正確 ✅</span>　${q.dataset.explain}`;
      }else{
        feedback.innerHTML = `<span class="err">錯誤 ❌</span>`;
        allCorrect = false;
      }
    }
  });

  // 全對顯示折扣碼
  const box = document.getElementById('discount');
  box.style.display = allCorrect ? 'block' : 'none';
});
</script>
</body>
</html>
